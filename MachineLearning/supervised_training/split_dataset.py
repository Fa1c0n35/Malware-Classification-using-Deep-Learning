
import argparse
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
import numpy as np

def main():

    TRAIN_SIZE = 0.7

    parser = argparse.ArgumentParser(description='Visualize DAE compressed output using UMAP algorithm.')
    parser.add_argument('csv_output', type=str, help='Output CSV file generated from DAE.py')
    args  = parser.parse_args()

    df = pd.read_csv(args.csv_output, header=None)

    msk = np.random.rand(len(df)) < TRAIN_SIZE
    train = df[msk]
    test = df[~msk]

    train.to_csv('train_dataset.csv', header=False, index=False)
    test.to_csv('test_dataset.csv', header=False, index=False)


if __name__ == '__main__':
    main()
