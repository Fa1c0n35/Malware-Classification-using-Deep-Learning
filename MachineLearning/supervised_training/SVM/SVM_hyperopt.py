
from hpsklearn import HyperoptEstimator, svc, any_classifier
from hyperopt import tpe

import pandas as pd


def main():

    df_train = pd.read_csv('../train_dataset.csv')
    df_test = pd.read_csv('../test_dataset.csv')

    X_train, y_train = df_train.iloc[:, 2:].values, df_train.iloc[:, 0].values
    X_test, y_test = df_test.iloc[:, 2:].values, df_test.iloc[:, 0].values

    estim = HyperoptEstimator(classifier=svc('mySVC'),
        algo=tpe.suggest, max_evals=100, trial_timeout=120, verbose=True)

    estim.fit(X_train, y_train)

    print("\n\n{}\n\n".format(estim.score(X_test, y_test)))
    print("\n\n{}\n\n".format(estim.best_model()))

if __name__ == '__main__':
    main()
