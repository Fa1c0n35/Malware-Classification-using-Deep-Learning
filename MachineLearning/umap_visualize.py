
import argparse
from umap import  UMAP
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

def main():

    parser = argparse.ArgumentParser(description='Visualize DAE compressed output using UMAP algorithm.')
    parser.add_argument('csv_output', type=str, help='Output CSV file generated from DAE.py')
    args  = parser.parse_args()

    df    = pd.read_csv(args.csv_output, header=None)
    label = df.iloc[:, 0]
    data  = df.iloc[:, 2:]

    umap = UMAP(n_components=2, verbose=1).fit_transform(data.values)

    df_umap          = pd.DataFrame()
    df_umap['x']     = umap[:, 0]
    df_umap['y']     = umap[:, 1]
    df_umap['label'] = label

    sns.lmplot('x', 'y', df_umap, hue='label', fit_reg=False, scatter_kws={"s": 10})
    plt.show()


if __name__ == '__main__':
    main()